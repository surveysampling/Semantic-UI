!function(e,t,n,a){e.fn.calendar=function(t){var o,r=e(this),i=r.selector||"",l=(new Date).getTime(),s=[],d=arguments[0],p="string"==typeof d,c=[].slice.call(arguments,1);return r.each(function(){var r,u,f=e.isPlainObject(t)?e.extend(!0,{},e.fn.calendar.settings,t):e.extend({},e.fn.calendar.settings),g=f.className,h=f.namespace,v=f.selector,m=f.formatter,D=f.parser,b=f.metadata,y=f.error,C="."+h,k="module-"+h,x=e(this),T=x.find(v.input),w=x.find(v.popup),F=x.find(v.activator),I=this,M=x.data(k);u={initialize:function(){u.debug("Initializing calendar for",I),r=u.get.isTouch(),f.inline?u.setup.inline():u.setup.popup(),u.setup.input(),u.create.calendar(),u.bind.events(),u.instantiate()},instantiate:function(){u.verbose("Storing instance of calendar"),M=u,x.data(k,M)},destroy:function(){u.verbose("Destroying previous calendar for",I),x.removeData(k),x.unbind.events()},setup:{popup:function(){if(e.fn.popup===a)return void u.error(y.popup);if(!F.length&&(F=x.children().first(),!F.length))return void u.error(y.activator);w.length||(w=e("<div/>").addClass(g.popup).prependTo(F.parent())),w.addClass(g.calendar);var t=f.onVisible,n=f.onHidden;T.length||(w.attr("tabindex","0"),t=function(){return w.focus(),f.onVisible.apply(w,arguments)},n=function(){return w.blur(),f.onHidden.apply(w,arguments)});var o=function(){return u.set.focusDate(u.get.date()),f.onShow.apply(w,arguments)},r=e.extend({},f.popupOptions,{popup:w,on:f.on,hoverable:"hover"===f.on,onShow:o,onVisible:t,onHide:f.onHide,onHidden:n});u.popup(r)},inline:function(){w=e("<div/>").addClass(g.calendar).appendTo(x),T.length||w.attr("tabindex","0")},input:function(){f.touchReadonly&&T.length&&r&&T.prop("readonly",!0)}},create:{calendar:function(){var t=new Date,n=u.get.date(),a=u.get.focusDate(),o=a||n||f.startDate||t;a||(a=o);var i=o.getMonth(),l=o.getFullYear(),s=new Date(l,i,1),d=new Date(l,i+1,0),p=new Date(l,i-1,1),c=new Date(l,i,0),h=new Date(l,i+1,1),v=(s.getDay()-f.firstDayOfWeek%7+7)%7,D=f.constantHeight?42:d.getDate()+v,b=Math.ceil(D/7);w.empty();var y=e("<table/>").addClass(g.table).appendTo(w),C=e("<thead/>").appendTo(y),k=e("<tr/>").appendTo(C),x=e("<th/>").addClass(g.prev).appendTo(k);x.data("date",p),x.toggleClass(g.disabledCell,!u.helper.isDateInRange(c)),e("<i/>").addClass(g.prevIcon).appendTo(x);var T=e("<th/>").attr("colspan","5").appendTo(k);T.text(m.header(o,f));var F=e("<th/>").addClass(g.next).appendTo(k);F.data("date",h),F.toggleClass(g.disabledCell,!u.helper.isDateInRange(h)),e("<i/>").addClass(g.nextIcon).appendTo(F);for(var I=e("<tr/>").appendTo(C),M=0;M<7;M++){var N=e("<th/>").appendTo(I);N.text(m.columnHeader((M+f.firstDayOfWeek)%7,f))}for(var E=1-v,H=e("<tbody/>").appendTo(y),O=0;O<b;O++)for(var R=e("<tr/>").appendTo(H),Y=0;Y<7;Y++,E++){var P=e("<td/>").addClass(g.cell).appendTo(R),S=new Date(l,i,E);P.text(S.getDate());var j=S.getMonth()!==i||!u.helper.isDateInRange(S);P.toggleClass(g.disabledCell,j),P.toggleClass(g.todayCell,u.helper.dateEqual(S,t)),P.toggleClass(g.activeCell,u.helper.dateEqual(S,n)),P.toggleClass(g.focusCell,!r&&u.helper.dateEqual(S,a)),P.data("date",S)}if(f.today){var q=e("<tr/>").appendTo(H),A=e("<td/>").attr("colspan","7").addClass(g.today).appendTo(q);A.text(m.today(f)),A.data("date",t)}}},refresh:function(){u.create.calendar()},bind:{events:function(){w.on("click"+C,u.event.click),w.on("mousedown"+C,u.event.mousedown),T.length?(T.on("input"+C,u.event.inputChange),T.on("focus"+C,u.event.inputFocus),T.on("blur"+C,u.event.inputBlur),T.on("keydown"+C,u.event.keydown)):w.on("keydown"+C,u.event.keydown)}},unbind:{events:function(){w.off(C),T.length&&T.off(C)}},event:{click:function(t){T.length&&T.focus(),t.preventDefault(),t.stopPropagation();var n=e(t.target);n.parent().data("date")&&(n=n.parent());var a=n.data("date");a&&(n.hasClass(g.prev)||n.hasClass(g.next)?u.set.focusDate(a):(u.set.date(a),f.closable&&u.popup("hide")))},mousedown:function(e){T.length&&e.preventDefault()},keydown:function(e){if(27!==e.keyCode&&9!==e.keyCode||u.popup("hide"),u.popup("is visible"))if(37===e.keyCode||38===e.keyCode||39===e.keyCode||40===e.keyCode){var t=37===e.keyCode?-1:38===e.keyCode?-7:39==e.keyCode?1:7,n=u.get.focusDate();n||(n=u.get.date()||new Date),n=new Date(n.getFullYear(),n.getMonth(),n.getDate()+t),u.set.focusDate(n)}else if(13===e.keyCode){var a=u.get.focusDate();a&&(u.set.date(a),f.closable&&u.popup("hide"))}38!==e.keyCode&&40!==e.keyCode||(e.preventDefault(),u.popup("show"))},inputChange:function(){var e=T.val(),t=D.date(e,f);t&&u.set.date(t,!1)},inputFocus:function(){u.popup("show"),w.addClass(g.active)},inputBlur:function(){var e=u.get.date(),t=m.date(e,f);T.val(t),w.removeClass(g.active)}},get:{date:function(){return x.data(b.date)},focusDate:function(){return x.data(b.focusDate)},isTouch:function(){try{return n.createEvent("TouchEvent"),!0}catch(e){return!1}}},set:{date:function(e,t){e=u.helper.sanitiseDate(e),e=u.helper.dateInRange(e),t=t!==!1;var n=m.date(e,f);f.onChange.call(I,e,n)!==!1&&(x.data(b.date,e),u.set.focusDate(e),t&&T.length&&T.val(n))},focusDate:function(e){e=u.helper.sanitiseDate(e),e=u.helper.dateInRange(e),x.data(b.focusDate,e),u.create.calendar()}},changeDate:function(e){u.set.date(e)},popup:function(){return F.popup.apply(F,arguments)},helper:{sanitiseDate:function(e){return e?(e instanceof Date||(e=D.date(""+e)),isNaN(e)?a:e):a},dateEqual:function(e,t){return!!e&&!!t&&e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()},dateDiff:function(e,t){return new Date(t.getFullYear(),t.getMonth(),t.getDate()).getTime()-new Date(e.getFullYear(),e.getMonth(),e.getDate()).getTime()},dateInRange:function(e){return e?f.minDate&&u.helper.dateDiff(e,f.minDate)>0?f.minDate:f.maxDate&&u.helper.dateDiff(f.maxDate,e)>0?f.maxDate:e:e},isDateInRange:function(e){return!(!e||f.minDate&&u.helper.dateDiff(e,f.minDate)>0||f.maxDate&&u.helper.dateDiff(f.maxDate,e)>0)}},setting:function(t,n){if(u.debug("Changing setting",t,n),e.isPlainObject(t))e.extend(!0,f,t);else{if(n===a)return f[t];f[t]=n}},internal:function(t,n){if(e.isPlainObject(t))e.extend(!0,u,t);else{if(n===a)return u[t];u[t]=n}},debug:function(){f.debug&&(f.performance?u.performance.log(arguments):(u.debug=Function.prototype.bind.call(console.info,console,f.name+":"),u.debug.apply(console,arguments)))},verbose:function(){f.verbose&&f.debug&&(f.performance?u.performance.log(arguments):(u.verbose=Function.prototype.bind.call(console.info,console,f.name+":"),u.verbose.apply(console,arguments)))},error:function(){u.error=Function.prototype.bind.call(console.error,console,f.name+":"),u.error.apply(console,arguments)},performance:{log:function(e){var t,n,a;f.performance&&(t=(new Date).getTime(),a=l||t,n=t-a,l=t,s.push({Name:e[0],Arguments:[].slice.call(e,1)||"",Element:I,"Execution Time":n})),clearTimeout(u.performance.timer),u.performance.timer=setTimeout(u.performance.display,500)},display:function(){var t=f.name+":",n=0;l=!1,clearTimeout(u.performance.timer),e.each(s,function(e,t){n+=t["Execution Time"]}),t+=" "+n+"ms",i&&(t+=" '"+i+"'"),(console.group!==a||console.table!==a)&&s.length>0&&(console.groupCollapsed(t),console.table?console.table(s):e.each(s,function(e,t){console.log(t.Name+": "+t["Execution Time"]+"ms")}),console.groupEnd()),s=[]}},invoke:function(t,n,r){var i,l,s,d=M;return n=n||c,r=I||r,"string"==typeof t&&d!==a&&(t=t.split(/[\. ]/),i=t.length-1,e.each(t,function(n,o){var r=n!=i?o+t[n+1].charAt(0).toUpperCase()+t[n+1].slice(1):t;if(e.isPlainObject(d[r])&&n!=i)d=d[r];else{if(d[r]!==a)return l=d[r],!1;if(!e.isPlainObject(d[o])||n==i)return d[o]!==a?(l=d[o],!1):(u.error(y.method,t),!1);d=d[o]}})),e.isFunction(l)?s=l.apply(r,n):l!==a&&(s=l),e.isArray(o)?o.push(s):o!==a?o=[o,s]:s!==a&&(o=s),l}},p?(M===a&&u.initialize(),u.invoke(d)):(M!==a&&M.invoke("destroy"),u.initialize())}),o!==a?o:r},e.fn.calendar.settings={name:"Calendar",namespace:"calendar",debug:!1,verbose:!1,performance:!1,firstDayOfWeek:0,constantHeight:!0,today:!1,closable:!0,monthFirst:!0,touchReadonly:!0,inline:!1,on:"click",startDate:!1,minDate:!1,maxDate:!1,popupOptions:{position:"bottom left",lastResort:"bottom left",prefer:"opposite"},text:{days:["S","M","T","W","T","F","S"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],today:"Today"},formatter:{header:function(e,t){return t.text.months[e.getMonth()]+" "+e.getFullYear()},columnHeader:function(e,t){return t.text.days[e]},date:function(e,t){if(!e)return"";var n=e.getDate(),a=t.text.months[e.getMonth()],o=e.getFullYear();return(t.monthFirst?a+" "+n:n+" "+a)+", "+o},today:function(e){return e.text.today}},parser:{date:function(e,t){if(!e)return null;if(e=(""+e).trim(),0===e.length)return null;var n,a,o,r=-1,i=-1,l=-1,s=e.split(t.regExp.dateDelimiter).slice(0,3);for(n=0;n<s.length;n++){var d=s[n];for(d=d.substring(0,Math.min(d.length,3)).toLowerCase(),a=0;a<t.text.months.length;a++){var p=t.text.months[a];if(p=p.substring(0,Math.min(d.length,Math.min(p.length,3))).toLowerCase(),p===d){i=a+1;break}}if(i>=0){s.splice(n,1);break}}for(n=s.length-1;n>=0;n--)if(a=parseInt(s[n]),!isNaN(a)&&a>31){l=a,s.splice(n,1);break}if(i<0)for(n=0;n<s.length;n++)if(o=n>1||t.monthFirst?n:1===n?0:1,a=parseInt(s[o]),!isNaN(a)&&1<=a&&a<=12){i=a,s.splice(o,1);break}for(n=0;n<s.length;n++)if(a=parseInt(s[n]),!isNaN(a)&&1<=a&&a<=31){r=a,s.splice(n,1);break}if(l<0)for(n=s.length-1;n>=0;n--)if(a=parseInt(s[n]),!isNaN(a)){a<99&&(a+=2e3),l=a,s.splice(n,1);break}return r<0&&i<0&&l<0?null:(r<0&&(r=1),i<0&&(i=1),l<0&&(l=(new Date).getFullYear()),new Date(l,i-1,r))}},onChange:function(e,t){return!0},onShow:function(){},onVisible:function(){},onHide:function(){},onHidden:function(){},selector:{popup:".ui.popup",input:"input",activator:"input"},regExp:{dateDelimiter:/[^\w\d]+/g},error:{popup:"UI Popup, a required component is not included in this page",activator:"No activator found for the calendar popup",method:"The method you called is not defined."},className:{calendar:"calendar",active:"active",popup:"ui popup",table:"ui seven column celled center aligned unstackable table",prev:"prev link",next:"next link",prevIcon:"chevron left icon",nextIcon:"chevron right icon",cell:"link",disabledCell:"disabled",activeCell:"active",focusCell:"focus",todayCell:"today",today:"link"},metadata:{date:"date",focusDate:"focusDate"}}}(jQuery,window,document);